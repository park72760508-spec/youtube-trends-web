<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔥 시니어 YouTube 트렌드 분석기 Pro | 전체 채널 스캔 시스템</title>
    
    <!-- CSS 파일 -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- 외부 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" 
            integrity="sha512-r22gChDnGvBylk90+2e/ycr3RVrDi8DIOkIGNhJlKfuyQM4tIRAI062MaV8sfjQKYVGjOBaZBOA87z+IhZE9DA==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" 
            integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer">
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
          rel="stylesheet" 
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
          crossorigin="anonymous" 
          referrerpolicy="no-referrer">
    
    <!-- 메타 태그 -->
    <meta name="description" content="🔥 전체 시니어 채널을 스캔하여 최상위 핫한 영상을 검출하는 막강한 트렌드 분석 도구">
    <meta name="keywords" content="시니어, YouTube, 트렌드, 전체스캔, 바이럴점수, 최상위영상, 핫한검출">
    
    <!-- PWA 지원 -->
    <meta name="theme-color" content="#3b82f6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="시니어트렌드Pro">
    <link rel="manifest" href="manifest.json">
    
    <!-- 파비콘 -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🔥</text></svg>">
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="container">
            <h1>
                <i class="fas fa-fire"></i>
                시니어 YouTube 트렌드 분석기 Pro
            </h1>
            <p class="subtitle">🚀 전체 시니어 채널 스캔 | 최상위 핫한 영상 검출 | 막강한 바이럴 점수 분석</p>
            <div class="header-badges">
                <span class="badge">🔥 Hot Detection</span>
                <span class="badge">📊 Full Scan</span>
                <span class="badge">🎯 Top Ranked</span>
            </div>
        </div>
    </header>

    <!-- API 상태 배너 -->
    <div id="apiStatusBanner" class="api-status-banner">
        <i class="fas fa-check-circle"></i>
        <span id="apiStatusText">YouTube API 키가 정상적으로 연결되었습니다</span>
    </div>
    
    <!-- 메인 콘텐츠 -->
    <main class="main-content">
        <div class="container">
            
            <!-- 새로운 전체 스캔 방식 소개 -->
            <section class="scan-method-info">
                <div class="method-card">
                    <div class="method-icon">🔍</div>
                    <div class="method-content">
                        <h3>전체 시니어 채널 스캔 시스템</h3>
                        <p>모든 시니어 관련 키워드로 전체 채널을 검색하여 최상위 핫한 영상만을 선별합니다</p>
                        <div class="method-features">
                            <span class="feature">✅ 50+ 키워드 동시 검색</span>
                            <span class="feature">✅ 바이럴 점수 자동 계산</span>
                            <span class="feature">✅ 최상위 순위별 정렬</span>
                            <span class="feature">✅ 1일~2주 유연한 기간 설정</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 검색 설정 섹션 (간소화) -->
            <section class="search-section">
                <div class="search-container">
                    <h2>🎯 전체 스캔 설정</h2>
                    
                    <div class="search-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="scanCategory">🎪 분석 카테고리</label>
                                <select id="scanCategory" class="form-control">
                                    <option value="all" selected>🌟 전체 카테고리 (종합 스캔)</option>
                                    <option value="health">🏥 건강 & 운동</option>
                                    <option value="hobby">🎨 취미 & 여가</option>
                                    <option value="cooking">🍳 요리 & 레시피</option>
                                    <option value="life">🏠 생활 정보</option>
                                    <option value="travel">✈️ 여행</option>
                                    <option value="tech">📱 시니어 테크</option>
                                </select>
                            </div>

                            <div class="form-group">
                              <label for="maxChannels">📡 검출 채널 상한 (10~1000)</label>
                              <input id="maxChannels" type="range" min="10" max="1000" step="10" class="form-control">
                              <small class="hint">현재: <strong><span id="maxChannelsValue">100</span></strong> 개</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="concurrency">⚙️ 동시 요청 수 (4~8)</label>
                                <input id="concurrency" type="range" min="4" max="8" step="1" class="form-control">
                                <small class="hint">현재: <strong><span id="concurrencyValue">4</span></strong> 개</small>
                            </div>


                            
                            <div class="form-group keyword-selection-group">
                                <label>🎯 검색 키워드 선택 (API 할당량 절약)</label>
                                <div class="keyword-selection-container">
                                    <!-- 전체 선택/해제 컨트롤 -->
                                    <div class="keyword-controls">
                                        <button type="button" id="selectAllKeywords" class="keyword-control-btn">
                                            <i class="fas fa-check-square"></i> 전체 선택
                                        </button>
                                        <button type="button" id="deselectAllKeywords" class="keyword-control-btn">
                                            <i class="fas fa-square"></i> 전체 해제
                                        </button>
                                        <button type="button" id="selectTier1Only" class="keyword-control-btn">
                                            🔥 핵심만
                                        </button>
                                        <span class="selected-count">선택된 키워드: <span id="selectedKeywordCount">0</span>개</span>
                                    </div>
                                    
                                    <!-- 키워드 티어별 섹션 -->
                                    <div class="keyword-tiers">
                                        <!-- Tier 1: 핵심 키워드 -->
                                        <div class="keyword-tier" data-tier="tier1">
                                            <div class="tier-header">
                                                <h4>🔥 핵심 키워드 (Tier 1)</h4>
                                                <p class="tier-description">가장 중요한 시니어 관련 키워드</p>
                                                <button type="button" class="tier-toggle" data-tier="tier1">
                                                    <i class="fas fa-check-square"></i> 전체 선택/해제
                                                </button>
                                            </div>
                                            <div class="keyword-grid" id="tier1Keywords">
                                                <!-- 동적으로 생성 -->
                                            </div>
                                        </div>
                                        
                                        <!-- Tier 2: 확장 키워드 -->
                                        <div class="keyword-tier" data-tier="tier2">
                                            <div class="tier-header">
                                                <h4>⭐ 확장 키워드 (Tier 2)</h4>
                                                <p class="tier-description">중요한 확장 검색 키워드</p>
                                                <button type="button" class="tier-toggle" data-tier="tier2">
                                                    <i class="fas fa-square"></i> 전체 선택/해제
                                                </button>
                                            </div>
                                            <div class="keyword-grid" id="tier2Keywords">
                                                <!-- 동적으로 생성 -->
                                            </div>
                                        </div>
                                        
                                        <!-- Tier 3: 세부 키워드 -->
                                        <div class="keyword-tier" data-tier="tier3">
                                            <div class="tier-header">
                                                <h4>🌟 세부 키워드 (Tier 3)</h4>
                                                <p class="tier-description">선택적 세부 검색 키워드</p>
                                                <button type="button" class="tier-toggle" data-tier="tier3">
                                                    <i class="fas fa-square"></i> 전체 선택/해제
                                                </button>
                                            </div>
                                            <div class="keyword-grid" id="tier3Keywords">
                                                <!-- 동적으로 생성 -->
                                            </div>
                                        </div>
                                    </div>


                                    <!-- API 키 풀 관리 섹션 -->
                                    <section class="api-key-management-section">
                                        <div class="api-key-container">
                                            <h2>🔑 API 키 풀 관리</h2>
                                            <p class="section-description">여러 개의 YouTube API 키를 등록하여 검색 할당량을 대폭 확장하세요.</p>
                                            
                                            <!-- API 키 추가 -->
                                            <div class="api-key-input-section">
                                                <div class="input-group">
                                                    <input type="text" 
                                                           id="apiKeyInput" 
                                                           placeholder="YouTube Data API v3 키를 입력하세요 (예: AIzaSy...)" 
                                                           class="api-key-input">
                                                    <button id="addApiKeyBtn" class="btn-primary">
                                                        <i class="fas fa-plus"></i> 키 추가
                                                    </button>
                                                    <button id="refreshApiKeyStatusBtn" class="btn-secondary">
                                                        <i class="fas fa-sync-alt"></i> 상태 새로고침
                                                    </button>
                                                    <button id="validateApiKeysBtn" class="btn-secondary">
                                                        <i class="fas fa-check-circle"></i> API 키 검증
                                                    </button>
                                                    
                                                </div>
                                                <div class="api-key-help">
                                                    <small>
                                                        💡 <strong>팁:</strong> 
                                                        <a href="https://console.developers.google.com/" target="_blank">Google Cloud Console</a>에서 
                                                        YouTube Data API v3를 활성화하고 API 키를 생성하세요. 키 개수에 제한은 없습니다!
                                                    </small>
                                                </div>
                                            </div>
                                            
                                            <!-- API 키 상태 표시 -->
                                            <div id="apiKeyStatusContainer" class="api-key-status-container">
                                                <div class="no-keys-message">
                                                    <i class="fas fa-key"></i>
                                                    <p>등록된 API 키가 없습니다. 위에서 API 키를 추가해보세요.</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </section>
                                    
                                    <!-- 예상 API 비용 표시 -->
                                    <div class="api-cost-estimate">
                                        <div class="cost-info">
                                            <span class="cost-label">예상 API 비용:</span>
                                            <span class="cost-value" id="estimatedCost">0</span>
                                            <span class="cost-unit">할당량</span>
                                        </div>
                                        <div class="cost-warning" id="costWarning" style="display: none;">
                                            ⚠️ 선택한 키워드가 많아 할당량이 부족할 수 있습니다.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            
                            <div class="form-group">
                                <label for="videoFormat">📺 영상 형식</label>
                                <select id="videoFormat" class="form-control">
                                    <option value="all" selected>🌟 전체 형식</option>
                                    <option value="shorts">📱 쇼츠 (60초 이하)</option>
                                    <option value="long">🎬 롱폼 (60초 초과)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="resultCount">🎯 검출 개수</label>
                                <select id="resultCount" class="form-control">
                                    <option value="20">상위 20개</option>
                                    <option value="50" selected>상위 50개</option>
                                    <option value="100">상위 100개</option>
                                    <option value="200">상위 200개</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="timeRange">📅 분석 기간</label>
                                <select id="timeRange" class="form-control">
                                    <option value="1day">🔥 최근 1일 (초핫 영상)</option>
                                    <option value="3days">⚡ 최근 3일 (급상승)</option>
                                    <option value="1week" selected>📈 최근 1주일 (인기 영상)</option>
                                    <option value="2weeks">📊 최근 2주일 (트렌드 분석)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="viewCountFilter">👁️ 최소 조회수</label>
                                <select id="viewCountFilter" class="form-control">
                                    <option value="all" selected>🌟 전체 조회수</option>
                                    <option value="1000000">🔥 100만 조회수 이상</option>
                                    <option value="500000">⭐ 50만 조회수 이상</option>
                                    <option value="100000">📈 10만 조회수 이상</option>
                                    <option value="10000">💫 1만 조회수 이상</option>
                                </select>
                            </div>
                            
                        </div>
                        
                        <!-- 전체 스캔 버튼 -->
                        <div class="scan-buttons">
                            <button id="fullScanBtn" class="btn-primary scan-btn">
                                <i class="fas fa-rocket"></i>
                                🔥 전체 채널 스캔 시작
                                <span class="scan-indicator">FULL SCAN</span>
                            </button>
                            
                            <button id="stopScanBtn" class="btn-danger" style="display: none;">
                                <i class="fas fa-stop"></i>
                                스캔 중지
                            </button>
                        </div>


                    </div>
                </div>
            </section>

            <!-- 스캔 진행 상황 -->
            <!-- 스캔 진행 상황 -->
            <section class="scan-progress" id="scanProgress" style="display: none;">
                <div class="progress-container">
                    <h3>🔥 전체 시니어 채널 스캔 진행 중</h3>
                    
                    <!-- 새로운 실시간 카운터 영역 추가 -->
                    <!-- 새로운 실시간 카운터 영역 추가 -->
                    <div class="realtime-counters">
                      <div class="counter-group">
                        <div class="counter-item primary">
                          <div class="counter-icon">📊</div>
                          <div class="counter-content">
                            <span class="counter-label">백데이터 수집</span>
                            <span class="counter-value" id="backgroundDataCount">0</span>
                          </div>
                          <div class="counter-animation"><div class="pulse-dot"></div></div>
                        </div>
                    
                        <div class="counter-item secondary">
                          <div class="counter-icon">🎯</div>
                          <div class="counter-content">
                            <span class="counter-label">검출 영상</span>
                            <span class="counter-value" id="detectedVideos">0</span>
                          </div>
                          <div class="counter-animation"><div class="pulse-dot"></div></div>
                        </div>
                    
                        <div class="counter-item accent">
                          <div class="counter-icon">⚡</div>
                          <div class="counter-content">
                            <span class="counter-label">처리 속도</span>
                            <span class="counter-value" id="processingRate">0/초</span>
                          </div>
                          <div class="counter-animation"><div class="pulse-dot"></div></div>
                        </div>
                      </div>
                    </div>

                    
                    <div class="progress-stats">
                        <div class="stat">
                            <span class="label">처리된 키워드</span>
                            <span class="value" id="processedKeywords">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">전체 키워드</span>
                            <span class="value" id="totalKeywords">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">발견된 영상</span>
                            <span class="value" id="foundVideos">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">API 할당량 사용</span>
                            <span class="value" id="quotaUsage">0</span>
                        </div>
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar">0%</div>
                    </div>
                    
                    <!-- 진행 후 계속 작업 애니메이션 -->
                    <div class="post-progress-animation" id="postProgressAnimation" style="display: none;">
                        <div class="working-indicator">
                            <div class="working-spinner"></div>
                            <div class="working-dots">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                        <div class="working-text">
                            <h4>🔥 백그라운드 데이터 수집 중...</h4>
                            <p id="backgroundWorkStatus">고품질 데이터를 위해 추가 분석이 진행되고 있습니다</p>
                        </div>
                    </div>
                    
                    <div class="current-action" id="currentAction">스캔을 시작합니다...</div>
                </div>
            </section>

            <!-- 분석 결과 요약 -->
            <section class="analysis-summary" id="analysisSummary" style="display: none;">
                <h2>📊 전체 스캔 분석 결과</h2>
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="card-icon">🎬</div>
                        <div class="card-content">
                            <h3 id="totalVideos">0</h3>
                            <p>총 검출 영상</p>
                        </div>
                    </div>
                    <div class="summary-card">
                        <div class="card-icon">🔥</div>
                        <div class="card-content">
                            <h3 id="avgViralScore">0</h3>
                            <p>평균 바이럴 점수</p>
                        </div>
                    </div>
                    <div class="summary-card">
                        <div class="card-icon">📱</div>
                        <div class="card-content">
                            <h3 id="shortsRatio">0%</h3>
                            <p>쇼츠 비율</p>
                        </div>
                    </div>
                    <div class="summary-card">
                        <div class="card-icon">📈</div>
                        <div class="card-content">
                            <h3 id="avgGrowthRate">0%</h3>
                            <p>평균 성장률</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 데이터 다운로드 섹션 -->
            <!-- 다운로드 섹션 (374-398줄) -->
            <section class="download-section">
                <h2>📥 데이터 다운로드</h2>
                <div class="download-buttons">
                    <button id="downloadExcel" class="download-btn excel">
                        <i class="fas fa-file-excel"></i>
                        <span>Excel 다운로드</span>
                        <small>화면 표시 데이터</small>
                    </button>
                    <button id="downloadJSON" class="download-btn json">
                        <i class="fas fa-file-code"></i>
                        <span>JSON 다운로드</span>
                        <small>화면 표시 데이터</small>
                    </button>
                    <button id="downloadBackgroundData" class="download-btn background">
                        <i class="fas fa-database"></i>
                        <span>백데이터 받기</span>
                        <small>전체 수집 데이터</small>
                    </button>
                    <button id="downloadPDF" class="download-btn pdf">
                        <i class="fas fa-file-pdf"></i>
                        <span>PDF 보고서</span>
                        <small>분석 리포트</small>
                    </button>
                </div>
            </section>

            <!-- 최상위 핫한 영상 결과 테이블 -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <div class="results-header">
                    <h2>🏆 최상위 핫한 영상 순위</h2>
                    <div class="results-controls">
                        <div class="sort-controls">
                            <label for="sortBy">📊 정렬 기준:</label>
                            <select id="sortBy" class="sort-select">
                                <option value="viralScore" selected>🔥 바이럴 점수</option>
                                <option value="viewCount">👁️ 조회수</option>
                                <option value="subscriberCount">👥 구독자수</option>
                                <option value="engagementRate">💬 참여율</option>
                                <option value="growthRate">📈 성장률</option>
                                <option value="publishedAt">📅 업로드일</option>
                            </select>
                            <select id="sortOrder" class="sort-select">
                                <option value="desc" selected>📉 높은순</option>
                                <option value="asc">📈 낮은순</option>
                            </select>
                            <button id="applySortBtn" class="btn-sort">
                                <i class="fas fa-sort"></i> 정렬 적용
                            </button>
                        </div>
                        <div class="view-controls">
                            <button id="cardViewBtn" class="view-btn active">
                                <i class="fas fa-th-large"></i> 카드 보기
                            </button>
                            <button id="tableViewBtn" class="view-btn">
                                <i class="fas fa-table"></i> 테이블 보기
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 카드 보기 -->
                <div id="cardView" class="video-cards">
                    <!-- 동적으로 생성 -->
                </div>
                
                <!-- 테이블 보기 -->
                <div id="tableView" class="video-table-container" style="display: none;">
                    <table class="video-table">
                        <thead>
                            <tr>
                                <th class="rank-col">순위</th>
                                <th class="video-col">영상 정보 <small>(제목 클릭시 링크)</small></th>
                                <th class="viral-col">바이럴 점수</th>
                                <th class="stats-col">조회수</th>
                                <th class="engagement-col">참여율</th>
                                <th class="growth-col">성장률</th>
                                <th class="format-col">형식</th>
                                <th class="date-col">업로드일</th>
                                <th class="action-col">액션</th>
                            </tr>
                        </thead>
                        <tbody id="videoTableBody">
                            <!-- 동적으로 생성 -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- 차트 분석 -->
            <section class="charts-section" id="chartsSection" style="display: none;">
                <h2>📊 전체 스캔 데이터 분석</h2>
                <div class="chart-grid">
                    <div class="chart-container">
                        <h3>🔥 바이럴 점수 분포</h3>
                        <canvas id="viralScoreChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>📱 쇼츠 vs 롱폼 비율</h3>
                        <canvas id="formatRatioChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>📈 카테고리별 성장률</h3>
                        <canvas id="categoryGrowthChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>⏰ 시간대별 업로드 트렌드</h3>
                        <canvas id="uploadTimeChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- 로딩 및 에러 상태 -->
            <div id="loadingOverlay" class="loading-overlay" style="display: none;">
                <div class="loading-content">
                    <div class="loading-spinner">🔥</div>
                    <h3>전체 시니어 채널 스캔 중...</h3>
                    <p>잠시만 기다려주세요. 최상위 핫한 영상을 검출하고 있습니다.</p>
                </div>
            </div>

            <div id="errorMessage" class="error-container" style="display: none;">
                <div class="error-content">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>스캔 중 오류가 발생했습니다</h3>
                    <p id="errorText">잠시 후 다시 시도해주세요.</p>
                    <button class="btn-secondary" onclick="location.reload()">
                        <i class="fas fa-refresh"></i>
                        페이지 새로고침
                    </button>
                </div>
            </div>
            
            <!-- 성공 메시지 컨테이너 추가 -->
            <div id="successMessage" class="success-container" style="display: none;">
                <div class="success-content">
                    <i class="fas fa-check-circle"></i>
                    <h3 id="successTitle">작업이 완료되었습니다</h3>
                    <p id="successText">성공적으로 처리되었습니다.</p>
                </div>
            </div>

        </div>
    </main>

    <!-- 푸터 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <h4>시니어 YouTube 트렌드 분석기 Pro</h4>
                    <p>전체 시니어 채널을 스캔하여 최상위 핫한 영상을 검출하는 막강한 도구</p>
                </div>
                <div class="footer-features">
                    <h5>Pro 기능</h5>
                    <ul>
                        <li>🔥 전체 채널 스캔 시스템</li>
                        <li>🎯 최상위 순위 검출</li>
                        <li>🚀 고급 바이럴 점수 계산</li>
                        <li>📊 실시간 진행 상황 표시</li>
                        <li>📥 다중 포맷 다운로드</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 시니어 YouTube 트렌드 분석기 Pro. 전체 스캔 시스템으로 진화!</p>
            </div>
        </div>
    </footer>

    <!-- 메인 스크립트 -->
    <script src="script.js"></script>
</body>
</html>
